@use '../../animations/animations';

ul:has(.tag[href='#tree-view']) {
    --indentation-guide-width: 2px;
    --indentation-guide-color: var(--background-secondary);
    --list-bullet-size: 0.8em;
    --list-indent: 4em;

    li::after {
        content: '';
        display: block;
        position: absolute;
        top: calc(-0.5em * var(--line-height-normal) - var(--indentation-guide-width) * 0.5);
        left: calc(-1 * var(--list-indent) - 0.8em);
        width: calc(var(--list-indent) + 2px);
        height: calc(1em * var(--line-height-normal));
        border: solid var(--indentation-guide-color);
        border-width: 0 0 var(--indentation-guide-width) var(--indentation-guide-width);
        border-bottom-left-radius: var(--radius-m);
        pointer-events: none;
    }

    ul::before {
        bottom: calc(0.5em * var(--line-height-normal) + 2px + var(--radius-m));
        top: calc(-0.5em * var(--line-height-normal) - var(--indentation-guide-width) * 0.5);
        z-index: 1;
    }

    .list-bullet {
        display: none;
    }

    .list-collapse-indicator {
        position: absolute;
        opacity: 1;
        top: calc(0.5em * var(--line-height-normal) - var(--list-bullet-size) * 0.5 + var(--list-spacing));
        left: calc(-0.8em - var(--list-bullet-size) * 0.5 + var(--indentation-guide-width) * 0.5);
        margin: 0;
        padding: 0;
        display: block;
        width: var(--list-bullet-size);
        height: var(--list-bullet-size);
        border-radius: 50%;
        background: var(--background-primary);
        border: 1px solid var(--color-accent);
        z-index: 2;
    }
    .list-collapse-indicator.is-collapsed {
        background: var(--color-accent);
    }
    .list-collapse-indicator:hover {
        background: color-mix(in srgb, var(--color-accent), var(--background-primary) 70%);
    }
    .list-collapse-indicator.is-collapsed:hover {
        background: color-mix(in srgb, var(--color-accent), var(--background-primary) 30%);
    }
    .list-collapse-indicator svg {
        display: none;
    }


    li:has(li:hover > .list-bullet:last-child),
    li:has(.list-bullet:last-child):hover {
        &::after {
            border-color: var(--color-accent);
        }
        > ul::before {
            border-color: var(--color-accent);
        }
    }


    li:has(> .list-bullet:last-child):hover::before {
        content: "";
        position: absolute;
        top: 0;
        right: 0;
        left: 0;
        bottom: 0;
        background: linear-gradient(to right,
            var(--color-accent),
            transparent 100%
        );
        opacity: 0.2;
        animation: bg-slide 0.5s ease-in-out;
    }
}